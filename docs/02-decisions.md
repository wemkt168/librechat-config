# 关键决策记录

## 2025-12-03

### 决策 1：协作流程模式
**日期**：2025-12-03  
**问题**：如何提高代码质量和执行准确性？  
**背景**：发现让 AI IDE 自己写代码容易出错（如 server.js 为空），需要更好的协作方式。

**决策**：采用混合方案
- **我（AI 助手）**：写完整代码（质量控制）
- **AI IDE（GitHub Copilot / Zeabur）**：负责执行+测试+反馈（执行准确性）
- **使用标准化指令模板**：明确任务、代码清单、执行步骤、测试要求、反馈要求

**影响**：
- ✅ 减少来回沟通，提高效率
- ✅ 代码质量可控（逻辑、错误处理、注释齐全）
- ✅ 执行准确性高（AI IDE 按明确步骤执行）

**后续**：建立标准化指令模板，所有新功能都按此流程执行

---

### 决策 2：Video 模型接入方式
**日期**：2025-12-03  
**问题**：LibreChat 不支持 `/v2/video/generations` 端点，如何接入 Video 模型？  
**背景**：
- AIMLAPI 的 Video 模型使用 `/v2/video/generations` 而非 `/v1/chat/completions`
- LibreChat 的配置系统只支持 Chat 和 Image（通过 `/v1/chat/completions` 和 `/v1/images/generations`）
- 直接在 librechat.yaml 中配置 Video 模型会导致 400 错误

**决策**：创建独立的 video-proxy 服务
- **独立 Node.js 服务**（Express）
- **代理 AIMLAPI 的 `/v2/video/generations`**
- **前端通过 HTTP 调用**（不通过 LibreChat 配置系统）

**影响**：
- ✅ Video 功能独立，不影响 LibreChat 主流程
- ✅ 可以灵活扩展（未来可以添加其他独立功能）
- ⚠️ 需要前端单独集成（不能直接在 LibreChat 界面中使用）

**后续**：
- 类似方式可以用于其他独立功能（Image、Code 等）
- 未来可以考虑写 LibreChat 插件，在对话中直接触发

---

### 决策 3：项目笔记系统架构
**日期**：2025-12-03  
**问题**：如何让 AI 主动追查项目历史和进度？如何避免 context 满了后丢失信息？  
**背景**：
- Context 满了需要开新对话，但会丢失之前的对话记忆
- 需要一种方式让新对话时能快速恢复上下文
- 需要累积项目笔记，方便查阅和审查

**决策**：在 workspace 根目录创建 `docs/` 文件夹
- **使用 Markdown 文件**（人类可读，AI 易解析）
- **结构化组织**：
  - `00-project-overview.md`：项目总览
  - `01-progress-log.md`：进度日志
  - `02-decisions.md`：关键决策（本文件）
  - `03-code-reference.md`：代码参考
  - `04-collaboration-log.md`：协作记录
  - `05-next-steps.md`：下一步计划
- **AI 可以主动搜索和读取**

**影响**：
- ✅ 新对话时可以快速恢复上下文
- ✅ 项目历史可追溯
- ✅ 减少重复解释，节省 token
- ✅ 便于代码审查和 debug

**后续**：
- 每次完成重要任务后更新进度日志
- 每次做重要决策时记录到决策文件
- 新对话开始时先读取 docs/ 了解背景

---

### 决策 4：Workspace 组织方式
**日期**：2025-12-03  
**问题**：如何组织项目文件，让 AI 能方便访问和修改？  
**背景**：需要明确 Workspace、Folder、File 的关系，以及如何让 AI 知道项目结构。

**决策**：
- **Workspace = 项目的"家"**：包含所有代码、文档、配置
- **Folder = 组织方式**：
  - `video-proxy/`：代码文件夹
  - `docs/`：项目笔记
  - 其他功能文件夹（未来添加）
- **File = 具体内容**：代码文件、笔记文件、配置文件

**影响**：
- ✅ AI 可以访问整个 Workspace
- ✅ 文件组织清晰，便于管理
- ✅ 所有内容都在一个地方，方便查阅和修改

---

## 历史决策

### 2025-12-02
- **决策**：使用 LibreChat + AIMLAPI 作为技术栈
- **原因**：LibreChat 提供现成的前端界面，AIMLAPI 提供统一的 API 网关
- **影响**：快速搭建，但需要处理一些集成问题

---

**最后更新**：2025-12-05 01:08






